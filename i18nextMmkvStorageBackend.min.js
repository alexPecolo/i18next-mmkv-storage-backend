!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):e.i18nextMmkvStorageBackend=n()}(this,function(){"use strict";function e(e){return r.call(o.call(arguments,1),function(n){if(n)for(var t in n)void 0===e[t]&&(e[t]=n[t])}),e}function n(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function t(){return{prefix:"i18next_res_",expirationTime:6048e5,versions:{}}}var i=[],r=i.forEach,o=i.slice,s=function(){function e(e,n){for(var t=0;t<n.length;t++){var i=n[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(n,t,i){return t&&e(n.prototype,t),i&&e(n,i),n}}(),u=(require("react-native-mmkv")||{}).MMKV,a=new u({id:"i18n"}),f={setItem:function(e,n){if(a)return a.set(e,n)},getItem:function(e,n){if(a)return a.getString(e)}},l=function(){function i(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};n(this,i),this.init(e,t),this.type="backend"}return s(i,[{key:"init",value:function(n){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.services=n,this.options=e(i,this.options||{},t())}},{key:"read",value:function(e,n,t){var i=(new Date).getTime();if(!a)return t(null,null);try{var r=f.getItem(""+this.options.prefix+e+"-"+n);if(r&&(r=JSON.parse(r),r.i18nStamp&&r.i18nStamp+this.options.expirationTime>i&&this.options.versions[e]===r.i18nVersion))return delete r.i18nVersion,delete r.i18nStamp,t(null,r);t(null,null)}catch(e){console.warn(err),t(null,null)}}},{key:"save",value:function(e,n,t){a&&(t.i18nStamp=(new Date).getTime(),this.options.versions[e]&&(t.i18nVersion=this.options.versions[e]),f.setItem(""+this.options.prefix+e+"-"+n,JSON.stringify(t)))}}]),i}();return l.type="backend",l});
